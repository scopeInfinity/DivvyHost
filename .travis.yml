language: java
install: ant jar
script:
  - bash ./dist/bin.sh install
  - cd ~
  - ~/Divvy/bin.sh start
  - sleep 10
  - ~/Divvy/bin.sh -test 2>&1 |
    grep "Another Instance is Running" || { echo "Not Running"; exit 1; }
  - ps aux
  - ps aux | grep "java -jar [Dd]ivvy[Hh]ost"
  - sleep 10
  - ~/Divvy/bin.sh -test 2>&1 | 
    grep "Another Instance is Running" || { echo "Still Running"; exit 1; }
  - ps aux | grep "java -jar [Dd]ivvy[Hh]ost" | awk '{print $2}' | xargs kill
  - sleep 5
  - ~/Divvy/bin.sh -test 2>&1 | grep "Another Instance is Running" || { echo "Still Running"; kill -9 `cat /tmp/divvy.pid` ; exit 1; }
  - echo "Execution and Termination Working Fine";

os:
  - linux
jdk:
  - oraclejdk8
  - oraclejdk7
